{"ts":1376757334123,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"AES_Init();\n\nvar block = \"hello world\";\n\nvar key = new Array(32);\nfor(var i = 0; i < 32; i++)\n  key[i] = i;\n\nAES_ExpandKey(key);\nvar mystring = AES_Encrypt(block, key);\n\nconsole.log(mystring);\n\nAES_Done();"]],"start1":0,"start2":0,"length1":0,"length2":205}]],"length":205}
{"contributors":[],"silentsave":false,"ts":1376757411390,"patch":[[{"diffs":[[-1,"AES_Init();\n\nvar block = \"hello world\";\n\nvar key = new Array(32);\nfor(var i = 0; i < 32; i++)\n  key[i] = i;\n\nAES_ExpandKey(key);\nvar mystring = AES_Encrypt(block, key);\n\nconsole.log(mystring);\n\nAES_Done("],[1,"var password = 'pass';\n\nformatPlaintext(password"],[0,");"]],"start1":0,"start2":0,"length1":205,"length2":50}]],"length":50,"saved":false}
{"ts":1376757478934,"patch":[[{"diffs":[[0," 'pass';"],[1,"\nvar rand = '';"],[0,"\n\nformat"]],"start1":14,"start2":14,"length1":16,"length2":31},{"diffs":[[0,"ssword);"],[1,"\n\nrijndaelEncrypt(password,)"]],"start1":57,"start2":57,"length1":8,"length2":36}]],"length":93,"saved":false}
{"ts":1376757499883,"patch":[[{"diffs":[[0,"ssword);"],[1,"\ngetRandomBytes(12);"],[0,"\n\nrijnda"]],"start1":57,"start2":57,"length1":16,"length2":36}]],"length":113,"saved":false}
{"ts":1376757600793,"patch":[[{"diffs":[[0,"var "],[-1,"rand"],[1,"key"],[0," = '';\n\n"],[1,"password ="],[0,"form"]],"start1":23,"start2":23,"length1":20,"length2":29},{"diffs":[[0,"sword);\n"],[1,"key = "],[0,"getRando"]],"start1":67,"start2":67,"length1":16,"length2":22},{"diffs":[[0,"s(12);\n\n"],[1,"var res = "],[0,"rijndael"]],"start1":94,"start2":94,"length1":16,"length2":26},{"diffs":[[0,"assword,"],[-1,")"],[1,"key,\"CBC\");\n\nconsole.log(res);"]],"start1":129,"start2":129,"length1":9,"length2":38}]],"length":167,"saved":false}
{"ts":1376762639608,"patch":[[{"diffs":[[0,"';\n\n"],[-1,"password =formatPlaintext(password"],[1,"function toHex(str) {\n    var hex = '';\n    for(var i=0;i<str.length;i++) {\n        hex += ''+str.charCodeAt(i).toString(16);\n    }\n    return hex;\n}\n\nfunction doEncryption(passwordPlainText)\n{\n  var pt, key;\n  \n  key = 'E8E9EAEBEDEEEFF0F2F3F4F5F7F8F9FA';\n     \n  pt = hex2s(toHex(passwordPlainText)"],[0,");\n"],[1,"  "],[0,"key = "],[-1,"getRandomBytes(12);\n\nvar res = rijndaelEncrypt(password,key,\"CBC\");\n\nconsole.log(res);"],[1,"hex2s(theForm.key.value);\n  theForm.ciphertext.value = byteArrayToHex(rijndaelEncrypt(pt, key, \"ECB\"));\n\n}\n\nfunction doDecryption() {\n  var ct, key;\n  var theForm = document.forms[0];\n  blockSizeInBits=128;\n  keySizeInBits = theForm.keySize[theForm.keySize.selectedIndex].value;\n\n  if (theForm.key.value.toLowerCase().indexOf(\"0x\") == 0)\n    theForm.key.value = theForm.key.value.substring(2);\n  if (theForm.ciphertext.value.toLowerCase().indexOf(\"0x\") == 0)\n    theForm.ciphertext.value = theForm.ciphertext.value.substring(2);\n  \n  if (theForm.key.value.length*4 != keySizeInBits) {\n    alert(\"For a \" + keySizeInBits + \" bit key, the hex string needs to be \" +\n          (keySizeInBits / 4) + \" hex characters long.\");\n    if (theForm.key.select)\n       theForm.key.select();\n    return;\n  }\n\n  if (theForm.ciphertext.value.length*4 != blockSizeInBits) {\n    alert(\"For a \" + blockSizeInBits + \" bit block, the hex ciphertext string needs to be \" +\n          (blockSizeInBits / 4) + \" hex characters long.\");\n    if (theForm.ciphertext.select)\n       theForm.ciphertext.select();\n    return;\n  }\n     \n  ct = hex2s(theForm.ciphertext.value);\n  key = hex2s(theForm.key.value);\n  theForm.plaintext.value = byteArrayToHex(rijndaelDecrypt(ct, key, \"ECB\"));\n\n}\n"]],"start1":34,"start2":34,"length1":133,"length2":1573}]],"length":1607,"saved":false}
{"ts":1376762747407,"patch":[[{"diffs":[[0,", key;\n "],[-1," "],[0,"\n  key ="]],"start1":240,"start2":240,"length1":17,"length2":16},{"diffs":[[0,"= hex2s("],[-1,"theForm.key.value"],[1,"key"],[0,");\n  the"]],"start1":345,"start2":345,"length1":33,"length2":19}]],"length":1592,"saved":false}
{"ts":1376762781457,"patch":[[{"diffs":[[0,";\n  "],[-1,"theForm.ciphertext.value"],[1,"var passwordEnc"],[0," = b"]],"start1":357,"start2":357,"length1":32,"length2":23},{"diffs":[[0,"CB\"));\n\n"],[1,"  return passwordEnc;\n"],[0,"}\n\nfunct"]],"start1":421,"start2":421,"length1":16,"length2":38}]],"length":1605,"saved":false}
{"ts":1376763001234,"patch":[[{"diffs":[[0,"s';\n"],[-1,"var key = '';"],[1,"password = doEncryption(password);\n"],[0,"\n\nfu"]],"start1":19,"start2":19,"length1":21,"length2":43},{"diffs":[[0,"t, key;\n"],[1,"  blockSizeInBits=128;\n  keySizeInBits =128;\n"],[0," \n  key "]],"start1":261,"start2":261,"length1":16,"length2":61},{"diffs":[[0,"ryption("],[-1,""],[0,""],[1,"passwordEnc"],[0,") {\n  va"]],"start1":535,"start2":535,"length1":16,"length2":27},{"diffs":[[0,"s = "],[-1,"theForm.keySize[theForm.keySize.selectedIndex].value"],[1,"128"],[0,";\n"],[-1,"\n"],[0,"  "],[-1,"if (theForm.key.value.toLowerCase().indexOf(\"0x\") == 0)"],[0,"\n  "],[1,"\n"],[0,"  "],[-1,"theForm.key.value = theForm.key.value.substring(2);\n  if (theForm.ciphertext.value.toLowerCase().indexOf(\"0x\") == 0)\n    theForm.ciphertext.value = theForm.ciphertext.value.substring(2);\n  \n  if (theForm.key.value.length*4 != keySizeInBits) {\n    alert(\"For a \" + keySizeInBits + \" bit key, the hex string needs to be \" +\n          (keySizeInBits / 4) + \" hex characters long.\");\n    if (theForm.key.select)\n       theForm.key.select();\n    return;\n  }\n\n  if (theForm.ciphertext.value.length*4 != blockSizeInBits) {\n    alert(\"For a \" + blockSizeInBits + \" bit block, the hex ciphertext string needs to be \" +\n          (blockSizeInBits / 4) + \" hex characters long.\");\n    if (theForm.ciphertext.select)\n       theForm.ciphertext.select();\n    return;\n  }\n     \n  ct = hex2s(theForm.ciphertext.value"],[1,"key = 'E8E9EAEBEDEEEFF0F2F3F4F5F7F8F9FA';\n\n  ct = hex2s(toHex(passwordEnc)"],[0,");\n "]],"start1":645,"start2":645,"length1":925,"length2":95},{"diffs":[[0,";\n  "],[-1,"theForm.p"],[1,"var passwordP"],[0,"lain"],[-1,"t"],[1,"T"],[0,"ext"],[-1,".value"],[0," = b"]],"start1":771,"start2":771,"length1":31,"length2":29},{"diffs":[[0,"CB\"));\n\n"],[1,"  return passwordPlainText;\n"],[0,"}\n"]],"start1":841,"start2":841,"length1":10,"length2":38}]],"length":879,"saved":false}
{"ts":1376763056652,"patch":[[{"diffs":[[0,"sword);\n"],[1,"console.log(password);\npassword = doDecryption(password);\nconsole.log(password);"],[0,"\n\nfuncti"]],"start1":50,"start2":50,"length1":16,"length2":96}]],"length":959,"saved":false}
{"ts":1376763319476,"patch":[[{"diffs":[[0," = doEncryption("],[1,"\"encrypted: \"+"],[0,"password);\nconso"]],"start1":31,"start2":31,"length1":32,"length2":46},{"diffs":[[0,"d);\nconsole.log("],[1,"\"Decrypted: \"+"],[0,"password);\n\nfunc"]],"start1":126,"start2":126,"length1":32,"length2":46},{"diffs":[[0,"x2s("],[-1,"theForm.key.value"],[1,"key"],[0,");\n "]],"start1":857,"start2":857,"length1":25,"length2":11}]],"length":973,"saved":false}
{"ts":1376763623341,"patch":[[{"diffs":[[0,"ion("],[-1,"\"encrypted: \"+"],[0,"pass"]],"start1":43,"start2":43,"length1":22,"length2":8},{"diffs":[[0,"ole.log("],[1,"\"encrypted: \"+"],[0,"password"]],"start1":62,"start2":62,"length1":16,"length2":30}]],"length":973,"saved":false}
{"ts":1376763835216,"patch":[[{"diffs":[[0,"urn hex;\n}\n\n"],[1,"function hex2a(hex) {\n    var str = '';\n    for (var i = 0; i < hex.length; i += 2)\n        str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));\n    return str;\n}\n\n"],[0,"function doE"]],"start1":307,"start2":307,"length1":24,"length2":195},{"diffs":[[0,";\n\n  ct = hex2s("],[-1,"toHex("],[0,"passwordEnc));\n "]],"start1":981,"start2":981,"length1":38,"length2":32},{"diffs":[[0,"wordEnc)"],[-1,")"],[0,";\n  key "]],"start1":1001,"start2":1001,"length1":17,"length2":16},{"diffs":[[0,"nText = "],[1,"hex2a("],[0,"byteArra"]],"start1":1049,"start2":1049,"length1":16,"length2":22},{"diffs":[[0,"ct, key, \"ECB\"))"],[1,")"],[0,";\n\n  return pass"]],"start1":1094,"start2":1094,"length1":32,"length2":33}]],"length":1144,"saved":false}
{"ts":1376766251341,"patch":[[{"diffs":[[-1,"var"],[1,"//get all"],[0," password = 'pas"]],"start1":0,"start2":0,"length1":19,"length2":25},{"diffs":[[0,"ord "],[-1,"= 'pass';\npassword = doEncryption(password);\nconsole.log(\"encrypted: \"+password);\npassword = doDecryption(password);\nconsole.log(\"Decrypted: \"+password);"],[1,"fields\n\nvar passwordFields = [];\n\nforeach (var form in document.forms){\n    \n}"],[0,"\n\nfu"]],"start1":15,"start2":15,"length1":161,"length2":86}]],"length":1075,"saved":false}
{"ts":1376766910782,"patch":[[{"diffs":[[0,"ds\n\n"],[-1,"var passwordFields = [];\n\nforeach (var form in document.forms){\n    \n}"],[1,"$(function(){\n    /* Hide form input values on focus*/ \n    $('input:password').each(function(){\n        var txtval = $(this).val();\n        $(this).focus(function(){\n            if($(this).val() == txtval){\n                $(this).val('')\n            }\n        });\n        $(this).blur(function(){\n            if($(this).val() == \"\"){\n                $(this).val(txtval);\n            }\n        });\n    });\n});"],[0,"\n\nfu"]],"start1":23,"start2":23,"length1":78,"length2":418}]],"length":1415,"saved":false}
{"ts":1376767957824,"patch":[[{"diffs":[[0,"al()"],[-1," == txtval"],[1,".length > 0"],[0,"){\n "]],"start1":218,"start2":218,"length1":18,"length2":19},{"diffs":[[0,"val("],[-1,"'')"],[1,") = doDecryption($(this).val());"],[0,"\n   "]],"start1":260,"start2":260,"length1":11,"length2":40}]],"length":1445,"saved":false}
{"ts":1376767992027,"patch":[[{"diffs":[[0,"al()"],[-1," == \"\""],[1,".length > 0"],[0,"){\n "]],"start1":380,"start2":380,"length1":14,"length2":19},{"diffs":[[0,"is).val("],[-1,"txt"],[1,") = doEncryption($(this)."],[0,"val"],[1,"()"],[0,");\n     "]],"start1":418,"start2":418,"length1":22,"length2":46}]],"length":1474,"saved":false}
{"ts":1376768084119,"patch":[[{"diffs":[[0,"fields\n\n"],[1,"var passwordFields = [];\n\n"],[0,"$(functi"]],"start1":19,"start2":19,"length1":16,"length2":42},{"diffs":[[0,"ach(function(){\n"],[1,"        passwordFields.push($(this))\n"],[0,"        var txtv"]],"start1":134,"start2":134,"length1":32,"length2":69}]],"length":1537,"saved":false}
{"ts":1376768087684,"patch":[[{"diffs":[[0,"$(this))"],[1,";"],[0,"\n       "]],"start1":178,"start2":178,"length1":16,"length2":17}]],"length":1538,"saved":false}
{"ts":1376768427921,"patch":[[{"diffs":[[0,"    });\n"],[-1,"});"],[1,"    \n    $('input:submit').each(function(){\n        $(this).submit(function(){\n            for(var i=0;i<passwordFields.length;i++){\n                passwordFields[i].value = doDecryption(passwordFields[i].value);\n            }\n        });\n    });\n});\n\n"],[0,"\n\nfuncti"]],"start1":549,"start2":549,"length1":19,"length2":269}]],"length":1788,"saved":false}
{"ts":1376768538728,"patch":[[{"diffs":[[0,"is).val("],[-1,") = "],[0,"doDecryp"]],"start1":320,"start2":320,"length1":20,"length2":16},{"diffs":[[0,"n($(this).val())"],[1,")"],[0,";\n            }\n"]],"start1":339,"start2":339,"length1":32,"length2":33},{"diffs":[[0,"val("],[-1,") = "],[0,"doEn"]],"start1":483,"start2":483,"length1":12,"length2":8},{"diffs":[[0,").val())"],[1,")"],[0,";\n      "]],"start1":506,"start2":506,"length1":16,"length2":17}]],"length":1782,"saved":false}
{"ts":1376768953637,"patch":[[{"diffs":[[0,";\n            }\n"],[1,"            \n            $(this).submit();\n            \n"],[0,"        });\n    "]],"start1":763,"start2":763,"length1":32,"length2":88}]],"length":1838,"saved":false}
{"ts":1376770675761,"patch":[[{"diffs":[[0,"ach(function(){\n"],[1,"        $(this).attr(\"easysec-enc\", \"decrypted\");\n"],[0,"        password"]],"start1":134,"start2":134,"length1":32,"length2":82},{"diffs":[[0,"val().length > 0"],[1," && $(this).attr(\"easysec-enc\") == \"encrypted\""],[0,"){\n             "]],"start1":331,"start2":331,"length1":32,"length2":78},{"diffs":[[0,"(this).val()));\n"],[1,"                $(this).attr(\"easysec-enc\", \"decrypted\");\n"],[0,"            }\n  "]],"start1":438,"start2":438,"length1":32,"length2":90},{"diffs":[[0,"ngth > 0"],[-1,")"],[1," &&  $(this).attr(\"easysec-enc\") == \"decrypted\") "],[0,"{\n      "]],"start1":602,"start2":602,"length1":17,"length2":65},{"diffs":[[0,"(this).val()));\n"],[1,"                $(this).attr(\"easysec-enc\", \"encrypted\");\n"],[0,"            }\n  "]],"start1":703,"start2":703,"length1":32,"length2":90}]],"length":2098,"saved":false}
{"ts":1376770704848,"patch":[[{"diffs":[[0,"h > 0 &&"],[-1," "],[0," $(this)"]],"start1":605,"start2":605,"length1":17,"length2":16}]],"length":2097,"saved":false}
{"ts":1376771338398,"patch":[[{"diffs":[[0," $('"],[-1,"input:submit"],[1,"form"],[0,"').e"]],"start1":818,"start2":818,"length1":20,"length2":12}]],"length":2089,"saved":false}
{"ts":1376771414929,"patch":[[{"diffs":[[0,"h;i++){\n"],[1,"                 $(passwordFields[i]).attr(\"easysec-enc\") == \"decrypted\"){\n                     \n                 }else{\n"],[0,"        "]],"start1":927,"start2":927,"length1":16,"length2":137},{"diffs":[[0,"value);\n"],[1,"                 }\n"],[0,"        "]],"start1":1129,"start2":1129,"length1":16,"length2":35}]],"length":2229,"saved":false}
{"ts":1376771424805,"patch":[[{"diffs":[[0,"        "],[1,"if("],[0,"$(passwo"]],"start1":944,"start2":944,"length1":16,"length2":19}]],"length":2232,"saved":false}
